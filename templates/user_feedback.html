<!--
  Copyright [2025] [OBARA (Nanjing) Electromechanical Co., Ltd]

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

{% extends 'base.html' %}

{% block title %}用户反馈 - 小原焊枪选型数据库{% endblock %}

{% block content %}
<div class="container mt-5">
    <div class="card shadow-lg fade-in-up">
        <div class="card-header bg-gradient-primary text-white">
            <h3 class="mb-0">
                <i class="bi bi-chat-dots me-2"></i>
                用户反馈
            </h3>
        </div>
        <div class="card-body p-5">
            <p class="text-muted mb-4">感谢您使用小原焊枪选型数据库！我们非常重视您的反馈，这将帮助我们不断改进产品和服务。</p>
            
            <form method="post" class="needs-validation" novalidate>
                {% csrf_token %}
                
                <!-- 反馈分类 -->
                <div class="mb-4">
                    <label for="category" class="form-label required">
                        <i class="bi bi-tag text-primary me-2"></i>
                        反馈分类 <span class="text-danger">(必选)</span>
                    </label>
                    <select class="form-select" id="category" name="category" required>
                        <option value="">请选择反馈分类</option>
                        <option value="数据错误">数据错误</option>
                        <option value="数据丢失">数据丢失</option>
                        <option value="系统错误">系统错误</option>
                        <option value="功能优化">功能优化</option>
                        <option value="其他建议">其他建议</option>
                    </select>
                    <div class="invalid-feedback">请选择反馈分类</div>
                </div>
                
                <!-- 反馈内容 -->
                <div class="mb-4">
                    <label class="form-label">
                        <i class="bi bi-file-text text-primary me-2"></i>
                        反馈内容
                    </label>
                    <div class="p-4 rounded-3 border">
                        <!-- 相关链接 -->
                        <div class="mb-3">
                            <label for="related_link" class="form-label">
                                <i class="bi bi-link text-secondary me-2"></i>
                                相关链接 <span class="text-muted">(可选)</span>
                            </label>
                            <input type="url" class="form-control" id="related_link" name="related_link" placeholder="请输入相关链接(如果适用)">
                            <div class="invalid-feedback">请输入有效的URL</div>
                        </div>
                        
                        <!-- 内容说明 -->
                        <div class="mb-3">
                            <label for="content" class="form-label required">
                        <i class="bi bi-pencil-square text-secondary me-2"></i>
                        内容说明 <span class="text-danger">(必填)</span>
                    </label>
                            <textarea class="form-control" id="content" name="content" rows="5" placeholder="请详细描述您的问题或建议" required></textarea>
                            <div class="invalid-feedback">请填写内容说明</div>
                        </div>
                    </div>
                </div>
                
                <!-- 联系方式 -->
                <div class="mb-4">
                    <label class="form-label">
                        <i class="bi bi-person text-primary me-2"></i>
                        联系方式 <span class="text-muted">(可选)</span>
                    </label>
                    <div class="p-4 rounded-3 border">
                        <div class="row g-3">
                            <!-- 姓名 -->
                            <div class="col-md-4">
                                <label for="contact_name" class="form-label">
                                    <i class="bi bi-person-fill text-secondary me-2"></i>
                                    姓名
                                </label>
                                <input type="text" class="form-control" id="contact_name" name="contact_name" placeholder="请输入您的姓名">
                            </div>
                            
                            <!-- 电话 -->
                            <div class="col-md-4">
                                <label for="contact_phone" class="form-label">
                                    <i class="bi bi-telephone-fill text-secondary me-2"></i>
                                    电话
                                </label>
                                <input type="tel" class="form-control" id="contact_phone" name="contact_phone" placeholder="请输入您的电话号码">
                            </div>
                            
                            <!-- 邮箱 -->
                            <div class="col-md-4">
                                <label for="contact_email" class="form-label">
                                    <i class="bi bi-envelope-fill text-secondary me-2"></i>
                                    邮箱
                                </label>
                                <input type="email" class="form-control" id="contact_email" name="contact_email" placeholder="请输入您的邮箱地址">
                                <div class="invalid-feedback">请输入有效的邮箱地址</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- 提交按钮 -->
                <div class="text-center mt-5">
                    <button type="submit" class="btn btn-primary btn-lg px-5 py-2" id="submit-btn" disabled>
                        <i class="bi bi-send me-2"></i>
                        提交反馈
                    </button>
                </div>
            </form>
        </div>
        <div class="card-footer text-center text-muted">
            <p class="mb-0">
                <i class="bi bi-info-circle me-1"></i>
                我们将尽快处理您的反馈，如有需要会与您联系。
            </p>
        </div>
    </div>
</div>

<script>
    // 表单验证
    (function () {
        'use strict'
        var forms = document.querySelectorAll('.needs-validation')
        Array.prototype.slice.call(forms)
            .forEach(function (form) {
                form.addEventListener('submit', function (event) {
                    if (!form.checkValidity()) {
                        event.preventDefault()
                        event.stopPropagation()
                    }
                    form.classList.add('was-validated')
                }, false)
            })
    })()
    
    // 动态验证，启用/禁用提交按钮
    document.addEventListener('DOMContentLoaded', function() {
        const categorySelect = document.getElementById('category');
        const contentTextarea = document.getElementById('content');
        const submitBtn = document.getElementById('submit-btn');
        
        // 检查字段是否已填写
        function checkFields() {
            const categoryValue = categorySelect.value.trim();
            const contentValue = contentTextarea.value.trim();
            
            // 如果分类和内容都已填写，则启用提交按钮
            if (categoryValue && contentValue) {
                submitBtn.disabled = false;
            } else {
                submitBtn.disabled = true;
            }
        }
        
        // 监听字段变化
        categorySelect.addEventListener('change', checkFields);
        contentTextarea.addEventListener('input', checkFields);
        
        // 初始检查
        checkFields();
    });
</script>
{% endblock %}
