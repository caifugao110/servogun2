# 📁 获取 Media 文件标准化流程

---

## 🔹 步骤一：从 PDM 导出原始数据

- 从 **PDM 系统** 中导出原始数据文件，例如：
  - `X2C-V3-C.csv`

---

## 🔹 步骤二：提取图号并下载 DWG 文件

1. 打开导出的 CSV 文件，定位到 **“图号1(o)”列**
2. 提取该列中的所有 **唯一图号**
3. 将这些图号复制到 **myprint 工具** 的图号表中
4. 在 myprint 中点击 **“根据图号表下载”** 按钮
5. 下载完成后的 DWG 文件将保存在以下路径：
   ```
   D:\temp\Download
   ```

---

## 🔹 步骤三：整理文件结构

将上述下载的 DWG 文件拷贝至主文件夹 `X2C-V3-C` 中，并将相关脚本、工具文件以及子文件夹统一置于该主目录下，形成如下所示的 **平级结构**：

### 📂 最终主目录结构示意：

```
X2C-V3-C/
├── [文件] 1双击获取DWG文件清单.bat
├── [文件] 2双击拷贝STEP文件.bat
├── [文件] 2双击拷贝STEP文件.ps1
├── [文件] DWGDocument list.csv
├── [文件] Copy step list.csv
├── [文件夹] DWG/          ← 存放所有 DWG 原始图纸文件
├── [文件夹] STEP/         ← 存放转换后的 STEP 文件
└── [文件夹] BMP/          ← 存放由 STEP 转换而来的 BMP 图像文件
```

> ✅ **说明**：所有文件（`.bat`, `.csv`）与三个文件夹（`DWG`, `STEP`, `BMP`）均处于 `X2C-V3-C` 目录的根层级，便于统一管理和操作。

---

## 🔹 步骤四：生成 DWG 清单 & 拷贝 STEP 文件

1. 双击运行：
   ```
   1双击获取DWG文件清单.bat
   ```
   - 自动生成文件：`DWGDocument list.csv`，记录当前 `DWG` 文件夹中的图纸清单

2. 再次双击运行：
   ```
   2双击拷贝STEP文件.bat
   ```
   - 将会把对应的 STEP 文件拷贝至 `STEP` 文件夹中，并生成文件：`Copy step list.csv`，用于查看拷贝失败的文件。

> 💡 **提示**：若你的电脑已安装 **PowerShell 7**，建议双击运行：
> ```
> 2双击拷贝STEP文件.ps1
> ```
> - 使用多线程机制，效率更高，速度更快。

---

## 🔹 步骤五：使用 AUTOVUE 批量转换 STEP 为 BMP

### ✅ 操作步骤如下：

1. 启动 **AUTOVUE** 软件，并打开任意一张 `.dwg` 文件（否则无法激活批量转换按钮）
2. 点击菜单栏：  
   **文件 → 转换 → 批量转换**
3. 在弹出窗口中：
   - 移除默认或旧的输入文件列表
   - 添加需要转换的 `.step` 文件（来自 `STEP` 文件夹）
4. 设置输出路径：
   - **保存在：** 输入 `BMP` 文件夹路径
5. 设置目标格式：
   - **转换到格式：** 选择 **"Windows Bitmap" (.bmp)**
6. 单击 **确定**，开始批量转换

---

## 🗂️ 最终完整目录结构一览

```
X2C-V3-C/
├── [文件] 1双击获取DWG文件清单.bat
├── [文件] 2双击拷贝STEP文件.bat
├── [文件] 2双击拷贝STEP文件.ps1
├── [文件] DWGDocument list.csv
├── [文件] Copy step list.csv
├── [文件夹] DWG/     ← 存放 DWG 图纸文件
├── [文件夹] STEP/    ← 存放 STEP 格式文件
└── [文件夹] BMP/     ← 存放转换后的 BMP 图像文件
```

---

📩 如需进一步自动化脚本支持或流程优化，请联系：  
📧 **gaoj@obara.com.cn**